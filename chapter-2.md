#### 什么是网络要分层

&nbsp;&nbsp;&nbsp;&nbsp;为什么网络要分层？复杂的东西都要分层，易于理解。比如开发一个网站，分后端，前端，后端细分为数据层，控制层，显示层等等。
所以网络也认为的划分为多层，而且标准不统一，常用OSI 从上到下7层模型： 应用层，表示层，会话层，传输层，网络层，数据链路层，物理层。有时候我们也会把应用层，
表示层，会话层统称为应用层，称为5层模型。每一层都有很多复杂的程序处理相应的场景。

&nbsp;&nbsp;&nbsp;&nbsp;这些程序是如何工作的？简单的想象这些程序的工作过程。后面会细化这些工作过程，我们先建立整体印象，逐渐细化，从面到点，自上而下的
理解计算机网络。

&nbsp;&nbsp;&nbsp;&nbsp;当一个网络包从一个网口经过时，首先看看要不要请进来，处理一把，有些网口配置了混杂模式，凡是经过的，全部都拿进来处理。包拿进来以后，
就要交给一段程序处理，调用process_layer2(buffer),网络部最好的理解就是一段buffer，当然，这个函数是虚构的，只是想象有这么个函数，这个函数的功能是什么呢？
从buffer中，摘掉二层的头，看一看，根据头里面的内容做什么操作。假设你发现包里的MAC地址和你的一样，那么说明这个包就是发给你的，这时候，你需要调用
process_layer3(buffer)。这个时候的buffer已经没有L2的头，在上一个函数中已经去掉了，在当前函数中，摘掉3层的头，看看到底是发给自己的，还是希望自己转发的。
如何判断？L3头里有IP地址，如果IP是你的，那么就是发给你的。

&nbsp;&nbsp;&nbsp;&nbsp;根据L3头里的IP，决定到底是调用process_tcp(buffer)，还是调用process_udp(buffer)。我们假设这个地址是TCP的，那么调用
process_tcp(buffer)；这时候，buffer中L3的头已经没了，这个时候需要看L4的头，看看这是一个发起，还是响应，又或者是一个正常的数据包，然后分别由不同的逻辑进行
处理，如果是发起或应答，接下来可能要发送一个回复包；如果是正常的数据包，就需要交给上层了，想当然的是process_htttp(buffer),但是，其实不是的，L4的包里有端口，
需要根据端口，找到对应的应用程序去处理了。不同的应用程序会监听不同的端口，如果这个包是发给浏览器的，那把HTTP包交个浏览器就ok了，和网络就没什么关系了。浏览器
会解析HTML，呈现精美的页面，用户看到后非常的开心，点击某一个按钮，点击事件被浏览器捕获，浏览器知道又要发起一个HTTP请求了，于是使用端口号，将请求发给你，应该
调用send_tcp(buffer),buffer就是HTTP信息，这个函数会加上一个TCP头，记录源端口，发送给目标端口。然后调用send_layer3(buffer)，加上IP头，接诊调用
send_layer2(buffer)，加MAC头，包括源MAC和目标MAC，如果不知道目标MAC，需要通过一定的协议处理过程，填上一个MAC地址，反正不能为空，然后就可以把数据包发出去。

&nbsp;&nbsp;&nbsp;&nbsp;层与层之间有没有什么关系呢？我们都知道TCP有3次握手，那么三次握手的时候，其它层就无所事事了？不是的，3次握手也是发送网络包，进行
通信。我们要记住的一点就是，网络上的包是完整的，只要有上层就必须有下层，不能中断。有个比喻我觉得比较贴切，一栋双子星的大楼，中间没有连通，从东塔到西塔，必须
从东塔下来，走过中间的通道(外部网络)，然后再上西塔。这是一个连续的整体，也是通网的必经之路。

&nbsp;&nbsp;&nbsp;&nbsp;这一节，又接触了很多新名称，HTTP，TCP，UDP，IP，MAC等等，这些的具体含义和设计会在后面继续细化。现在应该已经有了网络的一个大概模型，
下一步，我们就要开始去领略各种细节之美。
